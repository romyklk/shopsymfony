{% extends 'base.html.twig' %}

{% block title %}Panier -{{parent()}}
{% endblock %}

{% block stylesheets %}
	<style>
		input[type=number]::-webkit-inner-spin-button {
			-webkit-appearance: none;
		}
	</style>
{% endblock %}


{% block body %}
{% set pageName = "Mon panier" %}
<div class="container-fluid">
	{% include "partials/_pagetitle.html.twig" %}
</div>
	<div class="container">
	
		<div class="row">
			<div class="col-md-12">

				<table class="table table-hover">
					<thead>
						<tr>
							<td>Produit</td>
							<td>Prix Unitaire</td>
							<td>Quantité</td>
							<td>Prix Total</td>
							<td>Actions</td>
						</tr>
					</thead>
					<tbody>
						
						{# on initialise la variable qui va stocker le montant total du panier #}
						{% for element in cart.products %}
							<tr>
								<td>
									<a href="" class='text-decoration-none text-dark'>
										<img src="assets/uploads/products/{{element.product.image}}" alt="{{element.product.name}}" class="img-thumbnail mx-2" width="50">
										{{element.product.name}}
									</a>
								</td>
								<td>{{element.product.price/100}}
									€</td>
								<td>
									<div class="input-group mb-3">

										<a href="{{path('app_cart_delete',{'id':element.product.id})}}" class="btn btn-outline-secondary" type="button" id="button-addon1">-</a>

										<input type="number" class="form-control text-center" value="{{element.quantity}}" min="0" max="100" style='width:5px'>
									{% if element.quantity < element.product.quantity %}
									<a href="{{path('app_cart_add',{'id':element.product.id})}}" class="btn btn-outline-secondary" type="button" id="button-addon2">+</a>
									{% else %}
									<a href="{{path('app_cart_add',{'id':element.product.id})}}" class="btn btn-outline-secondary disabled" type="button" id="button-addon2">+</a>
									{% endif %}

									</td>
								</td>
								<td>{{element.product.price /100 * element.quantity}}
									€</td>
								<td>
									<a href="{{path('app_cart_remove',{'id':element.product.id})}}" class="btn btn-danger">
										<i class="bi bi-trash3"></i>
									</a>
								</td>
							</tr>
						{% endfor %}

						{# si le panier est vide on affiche un message #}
						{% if cart.data.subtotal == 0 %}
							<tr>
								<td colspan="5" class="text-center border-0">Votre panier est vide</td>
							</tr>

							{# sinon on affiche le total du panier #}
						{% else %}
							<tr>
								<td colspan="3" class="text-end border-0 fw-bold h6 text-muted">TVA incluse</td>
								<td class="border-0 fw-bold h6 text-muted">{{cart.data.taxes}}	€</td>
							</tr>
							<tr>
								<td colspan="3" class="text-end border-0 fw-bold h6">Total TTC</td>
								<td class="border-0 fw-bold h6">{{cart.data.subtotal}}
									€</td>
							</tr>

						{% endif %}
					</tbody>
				</tr>


				{# on affiche le total du panier #}


			</tbody>
		</table>

		{% if cart.data.subtotal != 0 %}
			<div class="d-grid gap-2 d-md-flex justify-content-md-end">
				<a href="{{path('app_cart_empty')}}" class="btn btn-warning">Vider mon panier</a>
				<a href="{{path('app_checkout')}}" class="btn btn-success">Passer commande</a>
			</div>

		{% endif %}


	</div>
</div></div>{% endblock %}
